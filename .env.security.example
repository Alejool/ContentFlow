# ============================================================================
# CONTENTFLOW SECURITY CONFIGURATION
# ============================================================================
# This file contains security-related environment variables for ContentFlow.
# Copy relevant sections to your .env file and configure as needed.
# ============================================================================

# ----------------------------------------------------------------------------
# RATE LIMITING
# ----------------------------------------------------------------------------
# Configure rate limiting behavior for API endpoints
# Recommendation: Use Redis for production (better performance)

CACHE_DRIVER=redis  # Required for rate limiting (redis recommended)
RATE_LIMIT_ENABLED=true

# ----------------------------------------------------------------------------
# TWO-FACTOR AUTHENTICATION (2FA)
# ----------------------------------------------------------------------------
# 2FA is automatically enabled for all admin users
# No additional configuration required - uses Laravel's encryption

# Optional: Customize 2FA settings in config/auth.php

# ----------------------------------------------------------------------------
# FILE UPLOAD SECURITY
# ----------------------------------------------------------------------------
# File validation is automatic via FileValidatorService
# Configure max upload sizes in php.ini:
# upload_max_filesize = 100M
# post_max_size = 100M

# ----------------------------------------------------------------------------
# CONTENT SANITIZATION
# ----------------------------------------------------------------------------
# AI content sanitization is automatic via ContentSanitizerService
# No additional configuration required

# ----------------------------------------------------------------------------
# AUDIT LOGGING
# ----------------------------------------------------------------------------
# Configure audit log retention period (days)
AUDIT_RETENTION_DAYS=365

# Enable audit log backups
AUDIT_BACKUP_ENABLED=true

# Audit log backup storage (S3 recommended for production)
AWS_AUDIT_BUCKET=contentflow-audit-logs

# ----------------------------------------------------------------------------
# TOKEN ENCRYPTION
# ----------------------------------------------------------------------------
# Social media tokens are automatically encrypted using APP_KEY
# CRITICAL: Keep APP_KEY secure and never commit to version control

APP_KEY=base64:GENERATE_WITH_php_artisan_key:generate

# Schedule for encryption key rotation (recommended: quarterly)
# Configure in app/Console/Kernel.php

# ----------------------------------------------------------------------------
# SECURITY ALERTS
# ----------------------------------------------------------------------------
# Enable security monitoring and alerts
SECURITY_ALERTS_ENABLED=true

# Email Alerts
SECURITY_ALERTS_MAIL_ENABLED=true
SECURITY_ALERTS_MAIL_RECIPIENTS=security@example.com,admin@example.com

# Slack Alerts (optional)
SECURITY_ALERTS_SLACK_ENABLED=false
SECURITY_ALERTS_SLACK_WEBHOOK=https://hooks.slack.com/services/YOUR/WEBHOOK/URL

# Discord Alerts (optional)
SECURITY_ALERTS_DISCORD_ENABLED=false
SECURITY_ALERTS_DISCORD_WEBHOOK=https://discord.com/api/webhooks/YOUR/WEBHOOK/URL

# Auto-blocking (use with caution - can lock out legitimate users)
SECURITY_AUTO_BLOCK_FAILED_AUTH=false
SECURITY_AUTO_BLOCK_RATE_LIMIT=false

# Alert for all role changes (not just admin elevation)
SECURITY_ALERT_ALL_ROLE_CHANGES=false

# Enable unusual access pattern detection (requires GeoIP)
SECURITY_UNUSUAL_ACCESS_ENABLED=false

# Testing mode (logs alerts but doesn't send)
SECURITY_ALERTS_TESTING_MODE=false

# ----------------------------------------------------------------------------
# SESSION SECURITY
# ----------------------------------------------------------------------------
# Secure session configuration
SESSION_DRIVER=redis  # Redis recommended for production
SESSION_LIFETIME=120  # Minutes (2 hours)
SESSION_ENCRYPT=true  # Always encrypt sessions
SESSION_SAME_SITE=lax  # CSRF protection (lax or strict)
SESSION_SECURE_COOKIE=true  # Only send over HTTPS (set to true in production)

# ----------------------------------------------------------------------------
# HTTPS/TLS
# ----------------------------------------------------------------------------
# Force HTTPS in production
APP_URL=https://your-domain.com  # Use https:// in production
ASSET_URL=https://your-domain.com

# ----------------------------------------------------------------------------
# CORS CONFIGURATION
# ----------------------------------------------------------------------------
# Configure allowed origins for API access
SANCTUM_STATEFUL_DOMAINS=your-domain.com,www.your-domain.com

# ----------------------------------------------------------------------------
# DATABASE SECURITY
# ----------------------------------------------------------------------------
# Use strong database credentials
DB_CONNECTION=pgsql
DB_HOST=127.0.0.1
DB_PORT=5432
DB_DATABASE=contentflow
DB_USERNAME=contentflow_user
DB_PASSWORD=STRONG_RANDOM_PASSWORD_HERE

# Enable SSL for database connections (production)
DB_SSLMODE=require  # For PostgreSQL
# DB_SSL_CA=/path/to/ca-cert.pem  # Path to CA certificate

# ----------------------------------------------------------------------------
# REDIS SECURITY
# ----------------------------------------------------------------------------
# Secure Redis configuration
REDIS_HOST=127.0.0.1
REDIS_PASSWORD=STRONG_REDIS_PASSWORD  # Always use password in production
REDIS_PORT=6379

# ----------------------------------------------------------------------------
# MAIL SECURITY
# ----------------------------------------------------------------------------
# Secure mail configuration for security alerts
MAIL_MAILER=smtp
MAIL_HOST=smtp.mailtrap.io
MAIL_PORT=587
MAIL_USERNAME=your_username
MAIL_PASSWORD=your_password
MAIL_ENCRYPTION=tls  # Use tls or ssl
MAIL_FROM_ADDRESS=noreply@your-domain.com
MAIL_FROM_NAME="${APP_NAME}"

# ----------------------------------------------------------------------------
# AWS S3 SECURITY
# ----------------------------------------------------------------------------
# Secure S3 configuration for file storage and backups
AWS_ACCESS_KEY_ID=YOUR_AWS_ACCESS_KEY
AWS_SECRET_ACCESS_KEY=YOUR_AWS_SECRET_KEY
AWS_DEFAULT_REGION=us-east-1
AWS_BUCKET=contentflow-production
AWS_AUDIT_BUCKET=contentflow-audit-logs

# Use IAM roles instead of keys when possible (EC2, ECS, Lambda)
# AWS_USE_PATH_STYLE_ENDPOINT=false

# ----------------------------------------------------------------------------
# SOCIAL MEDIA API KEYS
# ----------------------------------------------------------------------------
# CRITICAL: These credentials provide access to user social accounts
# Keep secure and never commit to version control

# Facebook/Instagram
FACEBOOK_CLIENT_ID=your_facebook_app_id
FACEBOOK_CLIENT_SECRET=your_facebook_app_secret
FACEBOOK_REDIRECT_URI=${APP_URL}/auth/facebook/callback

# Twitter/X
TWITTER_CLIENT_ID=your_twitter_client_id
TWITTER_CLIENT_SECRET=your_twitter_client_secret
TWITTER_REDIRECT_URI=${APP_URL}/auth/twitter/callback

# YouTube/Google
YOUTUBE_CLIENT_ID=your_google_client_id
YOUTUBE_CLIENT_SECRET=your_google_client_secret
YOUTUBE_REDIRECT_URI=${APP_URL}/auth/youtube/callback

# TikTok
TIKTOK_CLIENT_KEY=your_tiktok_client_key
TIKTOK_CLIENT_SECRET=your_tiktok_client_secret
TIKTOK_REDIRECT_URI=${APP_URL}/auth/tiktok/callback

# ----------------------------------------------------------------------------
# AI API KEYS
# ----------------------------------------------------------------------------
# Secure AI service credentials

# OpenAI
OPENAI_ENABLED=true
OPENAI_API_KEY=your_openai_api_key
OPENAI_MODEL=gpt-4-turbo

# Gemini
GEMINI_ENABLED=true
GEMINI_API_KEY=your_gemini_api_key
GEMINI_MODEL=gemini-pro

# DeepSeek
DEEPSEEK_ENABLED=false
DEEPSEEK_API_KEY=your_deepseek_api_key
DEEPSEEK_MODEL=deepseek-chat

# ----------------------------------------------------------------------------
# LOGGING
# ----------------------------------------------------------------------------
# Configure logging for security events
LOG_CHANNEL=stack
LOG_LEVEL=info  # Use 'info' or 'warning' in production (not 'debug')

# Separate security log channel (configured in config/logging.php)
LOG_SECURITY_CHANNEL=security

# ----------------------------------------------------------------------------
# BACKUP CONFIGURATION
# ----------------------------------------------------------------------------
# Configure automatic backups
BACKUP_ENABLED=true
BACKUP_DISK=s3  # Where to store backups
BACKUP_NOTIFICATION_EMAIL=admin@example.com

# ----------------------------------------------------------------------------
# MONITORING & OBSERVABILITY
# ----------------------------------------------------------------------------
# Optional: Configure external monitoring services

# Sentry (Error Tracking)
SENTRY_LARAVEL_DSN=your_sentry_dsn
SENTRY_TRACES_SAMPLE_RATE=0.1

# Datadog (APM)
DD_AGENT_HOST=localhost
DD_TRACE_ENABLED=true

# New Relic (APM)
NEW_RELIC_LICENSE_KEY=your_license_key
NEW_RELIC_APP_NAME=ContentFlow

# ----------------------------------------------------------------------------
# PRODUCTION SECURITY CHECKLIST
# ----------------------------------------------------------------------------
# Before deploying to production, ensure:
# 
# [ ] APP_DEBUG=false
# [ ] APP_ENV=production
# [ ] Strong APP_KEY generated
# [ ] HTTPS enabled (APP_URL uses https://)
# [ ] SESSION_SECURE_COOKIE=true
# [ ] Strong database password
# [ ] Redis password set
# [ ] All API keys secured
# [ ] Rate limiting enabled with Redis
# [ ] 2FA enabled for all admins
# [ ] Security alerts configured
# [ ] Audit logging enabled
# [ ] Backup system configured and tested
# [ ] File permissions set correctly (chmod 600 .env)
# [ ] .env not committed to version control
# [ ] Security headers configured (see config/security-headers.php)
# [ ] CORS properly configured
# [ ] Error pages don't leak sensitive info
# 
# ----------------------------------------------------------------------------

# ============================================================================
# END OF SECURITY CONFIGURATION
# ============================================================================
# 
# For more information, see:
# - docs/SECURITY_OVERVIEW.md
# - docs/SECURITY_2FA_SETUP.md
# - docs/SECURITY_KEY_ROTATION.md
# - docs/SECURITY_AUDIT_BACKUP.md
# - docs/SECURITY_ALERTS_SETUP.md
# 
# ============================================================================
